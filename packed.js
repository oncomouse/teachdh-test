Array.prototype.reduce||Object.defineProperty(Array.prototype,"reduce",{value:function(r){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof r)throw new TypeError(r+" is not a function");var t,e=Object(this),n=e.length>>>0,o=0;if(arguments.length>=2)t=arguments[1];else{for(;o<n&&!(o in e);)o++;if(o>=n)throw new TypeError("Reduce of empty array with no initial value");t=e[o++]}for(;o<n;)o in e&&(t=r(t,e[o],o,e)),o++;return t}}),Array.prototype.filter||(Array.prototype.filter=function(r,t){"use strict";if("Function"!=typeof r&&"function"!=typeof r||!this)throw new TypeError;var e,n=this.length>>>0,o=new Array(n),i=this,f=0,y=-1;if(void 0===t)for(;++y!==n;)y in this&&(e=i[y],r(i[y],y,i)&&(o[f++]=e));else for(;++y!==n;)y in this&&(e=i[y],r.call(t,i[y],y,i)&&(o[f++]=e));return o.length=f,o}),Array.prototype.map||(Array.prototype.map=function(r){var t,e,n;if(null==this)throw new TypeError("this is null or not defined");var o=Object(this),i=o.length>>>0;if("function"!=typeof r)throw new TypeError(r+" is not a function");for(arguments.length>1&&(t=arguments[1]),e=new Array(i),n=0;n<i;){var f,y;n in o&&(f=o[n],y=r.call(t,f,n,o),e[n]=y),n++}return e});function pluck(key,list){return list.map(function(item){return item[key]})}function uniq(list){return list.filter(function(item,index){return list.indexOf(item)===index})}function flatten(list,d){var d=d||Infinity;return d>0?list.reduce(function(acc,val){return acc.concat(Array.isArray(val)?flatten(val,d-1):val)},[]):list.slice()}function nl2array(nodeList){return Array.prototype.slice.call(nodeList)}var hasClass=typeof document.documentElement.classList=="undefined"?function(el,clss){return el.className&&new RegExp("(^|\\s)"+clss+"(\\s|$)").test(el.className)}:function(el,clss){return el.classList.contains(clss)};function toggleClass(el,clss){if(typeof document.documentElement.classList=="undefined"){el.classList.toggle(clss)}else{var classes=el.className.split(" ");var i=classes.indexOf(clss);if(i>=0)classes.splice(i,1);else classes.push(clss);el.className=classes.join(" ")}}function show(element){if(!element.hasAttribute("data-display")){var temp=document.body.appendChild(document.createElement(element.nodeName));element.setAttribute("data-display",window.getComputedStyle(element).getPropertyValue("display"));document.body.removeChild(temp)}element.style.display=element.getAttribute("data-display")}function hide(element){if(!element.hasAttribute("data-display")){var temp=document.body.appendChild(document.createElement(element.nodeName));element.setAttribute("data-display",window.getComputedStyle(element).getPropertyValue("display"));document.body.removeChild(temp)}element.style.display="none"}var ACTIVE_CLASS="active";function search(fuse,target){return pluck("item",fuse.search(target))}document.addEventListener("DOMContentLoaded",function(){var fuseData=nl2array(document.querySelectorAll("article")).map(function(article){return{id:article.getAttribute("id"),title:article.querySelector("h1").innerText,content:article.querySelector("main").innerText,categories:nl2array(article.querySelectorAll("header li")).map(function(li){return li.innerText})}});var categories=uniq(flatten(pluck("categories",fuseData)));var fuse={questions:new Fuse(fuseData,{keys:["title","content"]})};document.querySelector("#titleList").addEventListener("results",function(ev){var input=ev.detail.input;var results=ev.detail.results;if(results.length===0&&input.length===0){document.querySelector("#titleList").innerHTML=""}else{document.querySelector("#titleList").innerHTML="<ul></ul>";results.map(function(result){var link=document.createElement("A");link.href="#";link.innerHTML=result.title;link.addEventListener("click",function(ev){ev.preventDefault();document.querySelector("#"+result.id).scrollIntoView({behavior:"smooth"})});var item=document.createElement("LI");item.insertAdjacentElement("beforeend",link);document.querySelector("#titleList ul").insertAdjacentElement("beforeend",item)})}});document.querySelector("#questions").addEventListener("filter",function(ev){var input=ev.detail.input;var results=ev.detail.results;if(results.length===0&&input.length===0){nl2array(document.querySelectorAll("article")).forEach(function(article){show(article)})}else{var ids=pluck("id",results);nl2array(document.querySelectorAll("article")).forEach(function(article){ids.indexOf(article.getAttribute("id"))>=0?show(article):hide(article)})}});document.querySelector("#searchBar").addEventListener("input",function(ev){ev.preventDefault();var value=ev.target.value;var results=search(fuse.questions,value);document.querySelector("#questions").dispatchEvent(new CustomEvent("filter",{detail:{results:results,input:value}}));document.querySelector("#titleList").dispatchEvent(new CustomEvent("results",{detail:{results:results,input:value}}))});categories.map(function(category){var button=document.createElement("BUTTON");button.innerHTML=category;button.setAttribute("data-target",category);button.addEventListener("click",function(ev){ev.preventDefault();var value=ev.target.getAttribute("data-target");var isActive=hasClass(ev.target,ACTIVE_CLASS);toggleClass(ev.target,ACTIVE_CLASS);nl2array(document.querySelector(".active")).filter(function(element){return element!==ev.target}).forEach(function(element){toggleClass(element,ACTIVE_CLASS)});document.querySelector("#questions").dispatchEvent(new CustomEvent("filter",{detail:{results:isActive?[]:fuseData.filter(function(x){return x.categories.indexOf(value)>=0}),input:isActive?"":value}}))});var item=document.createElement("LI");item.insertAdjacentElement("beforeend",button);document.querySelector("#categories ul").insertAdjacentElement("beforeend",item)})});